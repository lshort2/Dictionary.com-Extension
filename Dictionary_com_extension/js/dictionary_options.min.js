var fcwidt=false;var bcwidt=false;var timer=0;$(document).ready(function(){$('#save_button').click(function(){var dic_prefs=JSON.parse(localStorage.dic_prefs);dic_prefs.use_popupdbclick.triggerValue=$('input#popup_dblclick_checkbox').is(':checked');dic_prefs.use_popupdbclick.triggerKey=$('select#popup_dblclick_key').val();dic_prefs.use_popupselect.triggerValue=$('input#popup_select_checkbox').is(':checked');dic_prefs.use_popupselect.triggerKey=$('select#popup_select_key').val();dic_prefs.use_definition.num=$('select#defintion_selector').val();dic_prefs.use_definition.synonyms=$('input#synonyms_checkbox').is(':checked');dic_prefs.use_window=$("input[name='direction']:checked").val();dic_prefs.use_color_style.fontType=$('select#fonttype_selector').val();dic_prefs.use_color_style.fontSize=$('select#fontsize_selector').val();dic_prefs.use_search_result=$('input#search_checkbox').is(':checked');localStorage.dic_prefs=JSON.stringify(dic_prefs);setOptions();$('#save_status').html('Options Saved');$('#save_status').show();if(timer!=0){clearTimeout(timer)}timer=setInterval(function(){$('#save_status').fadeOut(500);clearTimeout(timer)},10000);localStorage.setItem("setLocalStorage",localStorage.dic_prefs);chrome.tabs.getSelected(null,function(tab){chrome.tabs.remove(tab.id)})});$('#reset_button').click(function(){var lcStorage=window.localStorage.getItem('setLocalStorage');if(lcStorage!=''&&lcStorage!=null){dic_prefs=JSON.parse(lcStorage)}else{dic_prefs=JSON.parse(localStorage.dic_prefs)}dic_prefs.use_popupdbclick.triggerValue=true;dic_prefs.use_popupdbclick.triggerKey='none';dic_prefs.use_popupselect.triggerValue=false;dic_prefs.use_popupselect.triggerKey='none';dic_prefs.use_definition.num=1;dic_prefs.use_definition.synonyms=true;dic_prefs.use_window='below';dic_prefs.use_color_style.fontType='Helvetica';dic_prefs.use_color_style.fontSize='13px';dic_prefs.use_search_result=true;localStorage.dic_prefs=JSON.stringify(dic_prefs);localStorage.setItem("setLocalStorage",localStorage.dic_prefs);setOptions();$('#save_status').html('Options Reset');$('#save_status').show();if(timer!=0){clearTimeout(timer)}timer=setInterval(function(){$('#save_status').fadeOut(500);clearTimeout(timer)},10000)});$('#save_status').hide();setOptions();$("input[name='direction']").click(function(){var lcStorage=window.localStorage.getItem('setLocalStorage');if(lcStorage!=''&&lcStorage!=null){dic_prefs=JSON.parse(lcStorage)}else{dic_prefs=JSON.parse(localStorage.dic_prefs)}dic_prefs.use_window=$(this).val();localStorage.dic_prefs=JSON.stringify(dic_prefs);localStorage.setItem("setLocalStorage",localStorage.dic_prefs);setOptions()})});function isInsideColorPicker(currentTarget){var current_element=currentTarget;var ceClass=$(currentTarget).attr("class");var fontcolorpicker_holder=document.getElementById('fontcolorpicker_holder');var bubblecolorpicker_holder=document.getElementById('bubblecolorpicker_holder');while(current_element&&current_element!=document.body){if(current_element==fontcolorpicker_holder||current_element==bubblecolorpicker_holder||ceClass=='dic-colorselector-color'){return true}current_element=current_element.parentNode}return false}function setOptions(){var lcStorage=window.localStorage.getItem('setLocalStorage');if(lcStorage!=''&&lcStorage!=null){dic_prefs=JSON.parse(lcStorage)}else{dic_prefs=JSON.parse(localStorage.dic_prefs)}var popupdbclick=dic_prefs.use_popupdbclick;var popupselect=dic_prefs.use_popupselect;$('input#popup_dblclick_checkbox').attr('checked',popupdbclick.triggerValue);$('select#popup_dblclick_key').val(popupdbclick.triggerKey);$('input#popup_select_checkbox').attr('checked',popupselect.triggerValue);$('select#popup_select_key').val(popupselect.triggerKey);var use_definition=dic_prefs.use_definition;$('select#defintion_selector').val(use_definition.num);$('input#synonyms_checkbox').attr('checked',use_definition.synonyms);$("input[name='direction']").each(function(){if($(this).val()==dic_prefs.use_window){$(this).attr('checked',dic_prefs.use_window)}else{$(this).attr('checked',false)}});var imageName="images/bubble_"+dic_prefs.use_window+".png";var position_img=chrome.extension.getURL(imageName);$('img#position_img').attr('src',position_img);fcwidt=false;bcwidt=false;var color_style=dic_prefs.use_color_style;$('select#fonttype_selector').val(color_style.fontType);$('select#fontsize_selector').val(color_style.fontSize);$('input#search_checkbox').attr('checked',dic_prefs.use_search_result)}